(function(s,i,v,c,m,h,o,r){"use strict";const g={apiKey:"",serverUrl:""},a=()=>({...g,...h.storage}),d=t=>{Object.assign(h.storage,t)},u=t=>{const e=a();e.apiKey=t,d(e)},y=t=>{const e=a();e.serverUrl=t,d(e)},I=()=>a().apiKey,p=()=>a().serverUrl,A=()=>{const t=a();return t.apiKey.trim()!==""&&t.serverUrl.trim()!==""};m.findByProps("openLazy","hideActionSheet");const S=m.findByProps("ActionSheet")?.ActionSheet;let l;var F={onLoad:()=>{console.log("[ImmichSave] Plugin loaded!"),S?(console.log("[ImmichSave] Found ActionSheet component, patching render method"),l=v.before("render",S,t=>{try{const[e]=t;if(console.log("[ImmichSave] ActionSheet render:",{sheetKey:e.sheetKey,hasOptions:!!e.options,optionsCount:e.options?.length||0}),e.sheetKey!=="MessageLongPressActionSheet"){console.log("[ImmichSave] Skipping ActionSheet:",e.sheetKey);return}console.log("[ImmichSave] Processing message ActionSheet:",e.sheetKey),e.options&&!e.options.some(n=>n?.label==="Save to Immich")&&(console.log("[ImmichSave] Adding Save to Immich option"),e.options.unshift({label:"Save to Immich",icon:c.getAssetIDByName("ic_download"),onPress:()=>{try{console.log("[ImmichSave] Save to Immich pressed!"),i.showToast("Save to Immich clicked! (functionality coming soon)",c.getAssetIDByName("ic_check")),e.hideActionSheet?.()}catch(n){console.error("[ImmichSave] Error in Save to Immich handler:",n),i.showToast("Error occurred",c.getAssetIDByName("ic_close_16px"))}}}),console.log("[ImmichSave] Successfully added Save to Immich option"))}catch(e){console.error("[ImmichSave] ActionSheet patch error:",e)}})):console.warn("[ImmichSave] Could not find ActionSheet component")},onUnload:()=>{l&&l()},settings:()=>{const[t,e]=o.React.useState(I()),[n,R]=o.React.useState(p()),f=()=>{u(t),i.showToast("API Key saved!",c.getAssetIDByName("ic_check"))},E=()=>{y(n),i.showToast("Server URL saved!",c.getAssetIDByName("ic_check"))};return o.React.createElement(o.React.Fragment,null,o.React.createElement(r.Forms.FormSection,{title:"Immich Configuration"},o.React.createElement(r.Forms.FormText,{style:{marginBottom:10}},"Configure your Immich server connection:"),o.React.createElement(r.Forms.FormInput,{placeholder:"Enter your Immich API Key",value:t,onChange:e,secureTextEntry:!0}),o.React.createElement(r.Forms.FormRow,{label:"Save API Key",onPress:f}),o.React.createElement(r.Forms.FormInput,{placeholder:"Enter Immich Server URL (e.g., https://immich.example.com)",value:n,onChange:R}),o.React.createElement(r.Forms.FormRow,{label:"Save Server URL",onPress:E})),o.React.createElement(r.Forms.FormSection,{title:"Status"},o.React.createElement(r.Forms.FormText,{style:{marginBottom:10}},A()?"\u2705 Immich is configured and ready to use!":"\u274C Please configure Immich settings above")))}};return s.default=F,Object.defineProperty(s,"__esModule",{value:!0}),s})({},vendetta.ui.toasts,vendetta.patcher,vendetta.ui.assets,vendetta.metro,vendetta.plugin,vendetta.metro.common,vendetta.ui.components);
