(function(s,i,u,n,m,h,o,a){"use strict";const v={apiKey:"",serverUrl:""},c=()=>({...v,...h.storage}),d=t=>{Object.assign(h.storage,t)},S=t=>{const e=c();e.apiKey=t,d(e)},y=t=>{const e=c();e.serverUrl=t,d(e)},I=()=>c().apiKey,p=()=>c().serverUrl,A=()=>{const t=c();return t.apiKey.trim()!==""&&t.serverUrl.trim()!==""};m.findByProps("openLazy","hideActionSheet");const g=m.findByProps("ActionSheet")?.ActionSheet;let l;var F={onLoad:()=>{console.log("[ImmichSave] Plugin loaded!"),g?(console.log("[ImmichSave] Found ActionSheet component, patching render method"),l=u.before("render",g,t=>{try{const[e]=t;if(console.log("[ImmichSave] ActionSheet render - full props:",{sheetKey:e.sheetKey,hasOptions:!!e.options,optionsCount:e.options?.length||0,allPropKeys:Object.keys(e),hasMessage:!!e.message,hasContent:!!e.content,hasData:!!e.data,title:e.title,header:e.header}),!(e.message||e.content?.message||e.data?.message)){console.log("[ImmichSave] Skipping ActionSheet - no message data found");return}console.log("[ImmichSave] Found ActionSheet with message data - proceeding"),e.options&&!e.options.some(r=>r?.label==="Save to Immich")&&(console.log("[ImmichSave] Adding Save to Immich option"),e.options.unshift({label:"Save to Immich",icon:n.getAssetIDByName("ic_download"),onPress:()=>{try{console.log("[ImmichSave] Save to Immich pressed!"),i.showToast("Save to Immich clicked! (functionality coming soon)",n.getAssetIDByName("ic_check")),e.hideActionSheet?.()}catch(r){console.error("[ImmichSave] Error in Save to Immich handler:",r),i.showToast("Error occurred",n.getAssetIDByName("ic_close_16px"))}}}),console.log("[ImmichSave] Successfully added Save to Immich option"))}catch(e){console.error("[ImmichSave] ActionSheet patch error:",e)}})):console.warn("[ImmichSave] Could not find ActionSheet component")},onUnload:()=>{l&&l()},settings:()=>{const[t,e]=o.React.useState(I()),[r,f]=o.React.useState(p()),R=()=>{S(t),i.showToast("API Key saved!",n.getAssetIDByName("ic_check"))},E=()=>{y(r),i.showToast("Server URL saved!",n.getAssetIDByName("ic_check"))};return o.React.createElement(o.React.Fragment,null,o.React.createElement(a.Forms.FormSection,{title:"Immich Configuration"},o.React.createElement(a.Forms.FormText,{style:{marginBottom:10}},"Configure your Immich server connection:"),o.React.createElement(a.Forms.FormInput,{placeholder:"Enter your Immich API Key",value:t,onChange:e,secureTextEntry:!0}),o.React.createElement(a.Forms.FormRow,{label:"Save API Key",onPress:R}),o.React.createElement(a.Forms.FormInput,{placeholder:"Enter Immich Server URL (e.g., https://immich.example.com)",value:r,onChange:f}),o.React.createElement(a.Forms.FormRow,{label:"Save Server URL",onPress:E})),o.React.createElement(a.Forms.FormSection,{title:"Status"},o.React.createElement(a.Forms.FormText,{style:{marginBottom:10}},A()?"\u2705 Immich is configured and ready to use!":"\u274C Please configure Immich settings above")))}};return s.default=F,Object.defineProperty(s,"__esModule",{value:!0}),s})({},vendetta.ui.toasts,vendetta.patcher,vendetta.ui.assets,vendetta.metro,vendetta.plugin,vendetta.metro.common,vendetta.ui.components);
